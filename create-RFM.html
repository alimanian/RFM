<!doctype html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>ساخت فایل RFM</title>
    <link rel="stylesheet" href="assets/css/bootstrap.rtl.min.css">
    <link rel="stylesheet" href="assets/css/style.css">
</head>

<body class="min-vh-100 d-flex flex-column justify-content-between bg-body-tertiary">

<header class="border-bottom border-2 pb-1 pt-3 text-center">
    <div class="container">
        <h1 class="h2">
            ساخت فایل RFM
        </h1>
        <p>
            <a href="./index.html">صفحه اصلی</a>
            |
            <a href="./create-RFM.html">ساخت RFM</a>
            |
            <a href="./process-RFM.html">پردازش RFM</a>
        </p>
    </div>
</header>

<main class="flex-grow-1 d-flex">
    <div class="container my-4 d-flex flex-column justify-content-between">
        <div>

            <div class="mb-3">

                <div>
                    <label for="excelFile" class="form-label">فایل Excel خریدهای مشتریان</label>
                    <input class="form-control" type="file" id="excelFile">
                </div>

            </div>

            <div id="afterSelectFile" style="display: none;" class="row g-3 align-items-end mb-3">

                <div class="col-12 col-sm-6 col-xxl-3">
                    <label for="IdSelect" class="form-label">ستون استخراج ID مشتریان</label>
                    <select id="IdSelect" class="form-select">
                    </select>
                </div>

                <div class="col-12 col-sm-6 col-xxl-3">
                    <label for="recencySelect" class="form-label">ستون استخراج Recency و Frequency</label>
                    <select id="recencySelect" class="form-select">
                    </select>
                </div>

                <div class="col-12 col-sm-6 col-xxl-3">
                    <label for="monetarySelect" class="form-label">ستون استخراج Monetary</label>
                    <select id="monetarySelect" class="form-select">
                    </select>
                </div>

                <div class="col-12 col-sm-6 col-xxl-3 text-center">
                    <button id="btnProcess" type="button" class="btn btn-primary w-100">پردازش</button>
                </div>

            </div>

            <div class="mb-3 text-center w-100">
                <a class="btn btn-success btn-lg" style="display: none;" href=""
                   download="Customers-RFM.xlsx"
                   id="downloadExcel">دانلود فایل پردازش شده</a>
            </div>

        </div>

        <div class="alert alert-light mb-3" role="alert">
            <h4 class="alert-heading">نکات مهم</h4>
            <ul>
                <li>
                    ستون موردنیاز برای استخراج پارامتر M ستون مربوط به مبلغ خرید است.
                </li>
                <li>
                    ستون موردنیاز برای استخراج پارامتر R و F ستون مربوط به تاریخ خرید است.
                </li>
                <li>
                    فایل تراکنش‌های مشتریان شما باید شامل آیدی مشتری، تاریخ خرید و مبلغ خرید باشد.
                </li>
                <li>
                    در صورتی که فایل شما دارای ستون‌های RFM است، از
                    <a href="./process-RFM.html">این صفحه</a>
                    برای پردازش و بخش‌بندی مشتریان استفاده کنید.
                </li>
                <li>
                    پس از پردازش نهایی و دانلود فایل اکسل آن را به صفحه
                    <a href="./process-RFM.html">بخش‌بندی مشتریان</a>
                    ببرید تا پردازش مربوط به RFM روی آن انجام شود.
                </li>
            </ul>
        </div>
    </div>
</main>

<footer class="border-top border-2 py-3">
    <div class="container text-center d-flex justify-content-between">
        <div>
            <a href="https://github.com/alimanian/RFM">سورس کد</a>
        </div>
        <div>
            توسعه داده شده توسط
            <a href="https://github.com/alimanian">علی مانیان</a>
        </div>
    </div>
</footer>

<script src="assets/js/bootstrap.min.js"></script>
<script src="assets/js/xlsx.full.min.js"></script>
<script src="assets/js/moment.js"></script>
<script>
    const state = 'create';
</script>
<script src="assets/js/script.js"></script>
</body>
</html>